# Breaking Monero 03: 0-Decoy and Chain Reactions

**Breaking Monero Episode 03: 0-Decoy and Chain Reactions**

https://youtu.be/1CfXHC2IFx4

Sarang and Justin discuss 0-decoy (0-mixin) rings, perhaps the oldest and best-studied past limitation of Monero. We discuss how research created for 0-decoy rings can be applied to other analysis types. We show a spreadsheet tool we use to test chain reaction impacts, which can be caused by a large number of possible Monero attacks. By understanding the basics of 0-decoy research, individuals can more easily understand how we study the potential impacts of other attacks and analysis. 

[Download the Spreadsheet](https://onedrive.live.com/view.aspx?resid=473062B43FF0AD33!23780&ithint=file%2cxlsx&authkey=!AOpTq2h4tkFKeUU)  

_**Episode Transcription**_
---

_**Justin:**_ Hello and welcome to the third episode of Breaking Monero. Breaking Monero is a series of episodes where we explain the limitations of Monero’s security and privacy in a comprehensive and understandable way. Today we’re talking about 0-decoy transactions, or 0-mixin transactions and the chain reaction effect that comes as a result of these. So a double episode today, but we’re going to try to keep it shorter than the other two in order to get a little bit more streamlined and specific here. So, as always, I’m Justin, we also have Sarang on here, if you want to say hi really quick, Sarang.

_**Sarang:**_ Hello, I go by Sarang Noether and I am one of the researchers who does work on behalf of the Monero Research Lab and the Monero community.

_**Justin:**_ Excellent, so I want to start off with a nice quick screen share from one of the presentations I gave at Defcon where I talked about these ring signatures specifically. You can see here, on the left of the screen, there is a ring signature. Everything that’s in this green oval here is all of the potential outputs that can be sent in a Monero transaction. Let’s say that this gold one, this gold one here that I have my cursor on is one true spent and has the key image that comes from it. And all these black pots of gold are just Monero outputs, or potential spends. For 0-decoy transactions, these are transactions that are sent without any other output being a possible spend. So if you see this transaction, you know that that is the actual output that is spent. You can see an example here, suppose this is another 0-decoy transaction. It’s a ring size of 1. You know that since only one output is possibly included in this ring, that this is truly the output that is spent there. As a result, you can say, since this was spent here, I can look at all other transactions that include this output and say, this output cannot be there. As the example here, the ring includes this output, so you can put a nice X through this output to say, hey obviously that output cannot truly have been spent. If we continue this along for several other transactions, where they each have their own set of 0-decoys, again, this are old Monero transactions that could be sent in Monero’s early history in 2014 and 2015. You can see that if every single other output is referenced in another 0-decoy transaction, then you can realize that one of the outputs is actually spent if there’s only one plausible spend left and therefore that ring signature is compromised. This is really the basics of a full 0-decoy attack or a 0-decoy form of analysis where you look at transactions where there is only one possible output spend, and you compare it to other transactions to learn information to whittle down and narrow down information. From there, since this output is known to be spent, in this one transaction, maybe the yellow one there, then any other transactions that include that output, for example this output created in TX 10, then we can also eliminate it here, shown in this second ring signature that’s on the right. You sort of have this propagating effect, this propagating effect is called the chain reaction. On a high level, this diagram helps summarize the idea of 0-decoy attacks and analysis on Monero and the sort of resounding chain reaction that results from these 0-decoy transactions. Does that look good to you Sarang?

_**Sarang:**_ Yeah absolutely. The way I visualize this iterative process in my head is like peeling away an onion. It’s not an exact analogy because things aren’t onions, but generally the idea is that people look at 0-decoy transactions and look for their appearance elsewhere, and you can start peeling those off of other rings and then eventually you might get some rings that then become 0-decoy transactions and then you can take those and iteratively work through larger rings. So you’re right, the whole idea is to iteratively find 0-decoy transactions using the property that 0-decoy transactions have outputs that are known to be spent. With Monero the whole goal is that we don’t want to know if an output is being spent or not because that makes it an invalid decoy for a future larger ring.

_**Justin:**_ So Monero moved to make 0-decoy transactions disallowed beginning in I believe March 2016. Is that correct?

_**Sarang:**_ Possibly, I feel I should have looked that up.

_**Justin:**_ Between that period of time when Monero raised the minimum ring size and until the onset of RingCT in early 2017, you still saw the 0-decoy analysis still have some, although decreasing, still had some measurable impact. You could still learn a lot about transactions. Why was that still the case that you could perform this analysis despite no one being able to send these transactions anymore?

_**Sarang:**_ Sure, so the whole idea of this is that it is iterative. So when you’re able to take early transactions and whittle away what the known decoys are to get to the true spends, you can push those forward into smaller rings and then a little bit into larger ones. So as ring size gets bigger, effectively the number of outputs that you’re able to whittle away from those larger rings ends up being less effective. So again, part of the reason why we have the larger ring size and that the ring size increases over time is so such analysis is less effective. It’s kind of a belt and suspenders approach, you’re adding in more decoys to ensure that that propagating effect has less of an effect. They still were effective to a degree, but the degree to which they were effective definitely went down over time. Part of the reason why that is, is the way that you choose your decoys, we haven’t really talked about exactly how we do that, we just use the word random, has changed over time. I know we’re going to be having a future episode about exactly how we choose outputs from the chain and why that matters when it comes to decoys. But suffice it to say that we started choosing out outputs has gotten better over time and that has also made this particular analysis less effective than it was before.

_**Justin:**_ Excellent, thanks. Can you speak a little bit about the history where Monero was learning about these 0-decoys? I know that there are the research papers [MRL-0001](https://www.getmonero.org/resources/research-lab/pubs/MRL-0001.pdf) and [MRL-0004](https://www.getmonero.org/resources/research-lab/pubs/MRL-0004.pdf) that talked about the idea, especially in regards to chain reactions. Those are specifically addressed in those research papers. And you said that there’s a new research paper, or relatively new research paper at least, that helps quantify these a little bit better?

_**Sarang:**_ Yeah, so the idea of this was known for quite some time, there were some internal discussion that eventually culminated in a couple of internal papers, MRL-0001 and MRL-0004 that talked about this in varying degrees. Some of this was in the form of an accidental, passive analysis, and some of which was an active analysis perspective where you might have someone that purposely injecting outputs into the chain that they then have some knowledge over. So you can look at it a few different ways. The extent that this actually happened on the later chain wasn’t really quantified until a couple of papers came out. One of which was, it actually had two different names, the name as an early preprint was a little different, but the later preprint from April 2017 is called [Empirical Analysis of Traceability in the Monero Blockchain](https://arxiv.org/abs/1704.04299). And then there was another later paper which has a confusingly similar name [Traceability Analysis of Monero’s Blockchain](https://eprint.iacr.org/2017/338.pdf) that did a really good job talking about a few different forms of analysis and did a good job starting to quantify those forms of analysis. What they showed, and the number that got floated around for a while, was that something like 65% of Monero outputs were known to be traceable by some combination of 0-mixin, chain reaction and maybe a couple other forms of analysis. Which on it’s face sounds very, very scary. If 65% of the outputs are known to be spent and should not be chosen as decoys for modern transactions, totally I, and everyone else is totally screwed. But again, the way that we choose out outputs is very, very unlikely and less likely over time to choose any of these. Later on, a lot of other papers seemed to rediscover this analysis, so we saw a swath of preprints that maybe introduced one or two, smaller forms of analysis, but also for some reason, tended to bring up this idea of chain reaction over and over again as part of that analysis; which I think led to some misunderstanding about what was already known about chain reactions. So we did a fairly independent look to see if we could reproduce those values in [MRL-0007](https://www.getmonero.org/resources/research-lab/pubs/MRL-0007.pdf) where we introduced another more general form of analysis, and we found approximately the same numbers. If you look at the chain, as a whole, from whatever point they looked at it, back towards the beginning of Monero’s history, you saw about 65% of outputs being known to be spent, based on this analysis. But if you look at modern transactions, in particular after the big RingCT switch, they’re vanishing. At the time that we did it, we found precisely zero outputs were vulnerable to this kind of analysis. Again, if you were to choose old outputs that were known to be compromised, that would be bad, but modern transactions do not do this.

_**Justin:**_ Exactly, I think that’s important to cover. In the last episode we talked about the idea of plausible deniability, 0-decoy transactions were a really important area to look at because it broke down the idea of plausible deniability of people’s transactions on Monero. You could explicitly look at just the information on Monero’s blockchain and determine that since this sort of transaction occurred, this output could not have possibly been spent anywhere else. So it was a really important consideration to look at, I know we have several responses out there, several research papers at this point that looks into this, but it’s important to distinguish Monero pre-RingCT and Monero with RingCT because it’s a night and day difference.

_**Sarang:**_ It is and it’s definitely worth noting that modern transactions that only use RingCT outputs, and for the most part, with vanishingly small exceptions, those are the transactions that happen. Early, pre-RingCT outputs, remember those were the ones where we had denominations like bills and stuff, those aren’t chosen or used. A lot of the papers did not make a clear enough distinction, and I think that muddied the waters for a while with this 65% number.

_**Justin:**_ Is there anything else, Sarang, that you wanted to mention on 0-decoy, 0-mixin transactions or do you want to focus now on the idea of chain reactions? Which continue to be something that we test other attack vectors with Monero, these chain reaction methods, because we don’t really look at 0-decoy, 0-mixin anymore because Monero has moved on from those.

_**Sarang:**_ That’s true, and to be fair, the idea of 0-mixin is what underlies the idea of chain reaction because it’s got this onion methodology for trying to piece transactions apart. As we’re going to talk about in later episodes, we have other methods of analysis to try to determine whether or not outputs are spent and you can apply the idea of chain reaction after you run those other analyses. So if I’m able to determine by some other means whether or not a another set of outputs are spent through my new clever analysis, whatever it might be, you can other take those outputs which you know are spent, those are effectively a 0-mixin transaction and you can then apply chain reaction off of those. In general, while we do find that being able to identify that some modern outputs have been spent does let you remove them from consideration from other modern transactions, again the entire point of a chain reaction is that you have to be able to do that enough so that you can get another large ring all the way down to one remaining output, and in general, we’re not able to do that. Which is good. Maybe in some transactions you can remove one, two, maybe more from consideration, but provided you don’t get down to one, you still have that plausible deniability.

_**Justin:**_ Excellent, I think it’s really important to cover the idea of 0-decoy because you can reuse the same sort of thinking that you do for these 0-decoy transactions which are really basic and easy to understand and for far more complicated attacks that try to recreate a sort of 0-mixin, 0-decoy situation. I think it’s important to show people. I have a [spreadsheet that I’m going to share](https://onedrive.live.com/view.aspx?resid=473062B43FF0AD33!23780&ithint=file%2cxlsx&authkey=!AOpTq2h4tkFKeUU) regarding how we evaluate this chain reaction and see under what network circumstances, with a variety of compromised outputs, that other transactions are also compromised. All right, so I use this pretty frequently, I created this in early 2018 to make a spreadsheet that’s easier for people to understand and this is really just an extension of MRL-0001 and MRL-0004. There aren’t any new ideas introduced here, it’s just really easy to play around with. So I have here, just for a really easy example, the ring size set to 3, so it’s a really low ring size, but this is Monero’s first mandatory minimum ring size. You can see here on the left, you have a different proportion of outputs that are compromised. These vary between 0 and technically not 100%, but essentially 100%. You can see the proportion of the time that the true outputs are revealed based off of being able to break down these ring signatures. So you can look and see directly the chain reaction effect. So if you say, half of the outputs are compromised, let’s say that half of the outputs are 0-decoy. You can go through and say that for 25% of the transactions, out of the box, just by doing this one level of analysis, are now compromised. And then you can say, we found these 25% new compromised outputs, let’s run the test again including this 25% just compromised. You can do this across several layers here until you ultimately take the sum of these amounts in this last column here, this is the total proportion of all the outputs that are compromised after the chain reaction impact. So if you have a circumstance where 50% of the outputs are revealed to be true under a certain circumstance, you can keep running tests and break down the integrity of another 29% of the outputs. So the total amount would be about 80% of the total outputs would be known to an outside attacker. These number don’t really mean anything, but a larger number means a larger chain reaction in the sense that they’re added together. You can see, if I put in a larger ring size, you can see here with a ring size of 11, that these chain reactions get very, very small. You’re down to a much smaller number than before. In relative terms, this is .01, before it was 1.24, and again, that number doesn’t really mean anything, it’s just a number that you can compare to other ring sizes. But you can see, for any specific amount, the first order effect is vanishingly small even for enormous amounts of compromised outputs. If we went to an incredible ring size, like 100, you can see that the chain reaction would have to be quite immense for it to have any substantial impact on other transactions. So I’m just going to quickly show the difference between Monero with ring size 3 and Monero with ring size 11, which it has now. With the chart here on the right, you can see on the bottom is the proportion of known compromised outputs to begin with and on the y axis you can see the proportion of transactions that were compromised, or proportion of rings that are compromised. You can see, with ring size 3, there’s far less protection than ring size 11. As the ring size gets larger and larger, these curves shift further and further to the right and get increasingly steep because it takes more to perform a chain reaction. This is what Sarang and I mean when we say that with large ring sizes, it really take a lot to have chain reactions on the Monero network. I find this resource to really be easy to help quantity what we mean with chain reactions. Again, this doesn’t have to be for 0-decoys that are affected, but could be any proportion of outputs that are affected and we can run tests regarding the information that we plug into this Excel spreadsheet that I generally find very valuable.

_**Sarang:**_ Yeah, thanks. And it’s also worth noting that while modern transactions are vastly unaffected by this particular kind of analysis, we do have a tool that is available as part of the Monero built-in toolset. We used to call it the blackball tool, we realized that it was a confusing name, I consider it just a spent output tool. It lets you take your copy of the blockchain and allows you to run all sorts of analyses, including this one, 0-decoy and chain reaction and internally flag those outputs that are known to be spent and should not be chosen as decoys and makes absolutely certain that you do not choose those as decoys. Again, the likelihood in a modern transaction of choosing an output that has been affected by this analysis is vanishingly small and we haven’t come up with any modern outputs yet. But for a transaction that has a lot of older, pre-RingCT outputs, it will still help you avoid those. The tool is inefficient to run because it does a lot of analysis, but if you take a belt and suspenders and glue the pants on yourself approach, a tool is available to help you do that.

_**Justin:**_ It’s generally my opinion that with large ring sizes, this tool really only helps us evaluate whether or not the network is under a severe attack. If you have a chain split, you can go evaluate...we’ll talk about chain splits later, it’s not necessarily a tool that people need to run for the sake of sending funds for a low risk transaction.

_**Sarang:**_ No, absolutely not. For 0-decoy transactions and for chain reaction, again modern transactions are unaffected.

_**Justin:**_ Excellent, I think we’ve covered most of the basics on 0-decoy and chain reactions. Hopefully this is a nice summary for people. Is there anything else you want to add to this conversation, Sarang?

_**Sarang:**_ Just that there was a lot of good research that originally went into this, both internally and by external researchers. And there continues to be research on this topic, even though we understand it pretty well, by researches who may not have read the previous papers or are adding things on to them. There are plenty of different papers and preprints available if you have a more scientific or mathematical bent to you and want to learn more about the analysis that led to our protections against this kind of analysis.

_**Justin:**_ Excellent, thank you Sarang for joining me. Thank you to the listeners for watching this latest episode of Breaking Monero. I’m glad this one was shorter, so hopefully it was nice and just all the information you need and not much else. We’ll keep trying to make episodes short for you all. With that, we’d like to say goodbye, make sure you watch our later episodes and take care.
