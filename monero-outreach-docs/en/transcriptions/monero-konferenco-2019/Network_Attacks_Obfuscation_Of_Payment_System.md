# Josh S  
_**Network Attacks and Obfuscation of Your Payment System**_  

Josh is the CTO at [Airfoil Services](https://airfoil.services/), his experience stems from years of operational security consulting for clients with a focus on privacy and security best practices. He has been involved in the cryptocurrency security sector for the past 7 years. 

**Network Attacks and Obfuscation of Your Payment System**  
_Josh S, Airfoil Capital_  
[youtu.be/4txc2VUwX9o](https://youtu.be/4txc2VUwX9o)  

MoneroTalk w/ Josh S (Airfoil Capital) & Lee Clagett (The Monero Project) at MoneroKon 2019! - [youtu.be/M9EKUtHpDzs](https://youtu.be/M9EKUtHpDzs) 

_**Abstract**_ 

There are privacy concerns when using any cryptocurrency. When using a privacy focused cryptocurrency, many of the issues surrounding privacy is overcome. There still remains the issue behind network monitoring. The privacy concerns surrounding your network infrastructure when using Monero and other privacy coins remains an important focal point. With the correct monitoring software, someone could possibly discover that you are using Monero. This type of information helps an attacker gather meta-data on you, which in turn exposes you, widening your attack surface. I will touch on Kovri and what it is trying to solve as well as how individuals can further obfuscate their transactions using services like kovri and others. I will also address other major privacy currencies and discuss where their major flaws are in terms of exposure of the individual over a network, as well as discussing what these currencies get right. Finally, I will address the future for the privacy currencies in terms of network data transmittance, specifically focusing on Monero, and possible solutions on where the community will go from here.

_**Transcription**_ 

Thank you. Hello, my name is Josh. Like Sarang just said, I'll be speaking about network attacks and obfuscations of private payment systems. A little background on me, I was involved in privacy and security consulting for clients that had publicly facing data that I would go and I would help them erase this data on the internet, and then, also, besides that I was consulting for clients that were ranging from high-net-worth individuals all the way up to exchanges building self-custodial wallets. So, right now I'm currently the CTO at [Airfoil Capital](https://airfoil.services/) but enough about me, let's get started.

First I want to mention what Monero does. I want to focus on what it currently offers, and then I want to address what users can do today in terms of network obfuscation. And then I also want to look at what other projects are doing, both the good and the bad and other crypto projects. And then finally I want to look at what Monero in the near-term, what they have on the roadmap, what is planned for Monero, and then also the long term, what are other possible protocol implementations that we can push into, so.

So, we all know at the protocol layer, Monero has [ringCT](https://web.getmonero.org/resources/moneropedia/ringCT.html), [ring signatures](https://web.getmonero.org/resources/moneropedia/ringsignatures.html), [stealth addresses](https://web.getmonero.org/resources/moneropedia/stealthaddress.html), but it doesn't really address anonymity on the network level. So this is my focus is really how we can further address this for the end-user.

Threat model, a threat model, what I'm looking for in this talk, what I'm focusing on is, who are we trying to keep this information from, or who are we trying to anonymize this data from? I'm looking at this as a global passive adversary. So global passive adversary meaning they observe all traffic on the network. They don't interact with it but they are able to collect all network information. 

Issues that exist today, network de-anonymization. So, there are tools that exist that anybody can use to capture packets, there's free and opensource tools that anybody can use, and they're protocol analyzers. They are able to analyze exactly what is happening with these packets. By doing this observation you can perform certain types of attacks. One specific example is a [correlation attack](https://en.wikipedia.org/wiki/Correlation_attack). If you collect enough information, somebody submitting some kind of information on the network, you can correlate, with enough packets you can correlate that this information is coming from this user, and by de-anonymizing or correlating that it's coming from, let's say this IP or this device, you could then perform censorship attacks. Censorship attacks, of course, saying listen, we're not going to-- this network isn't going to accept any kind of information from this node, or these nodes, or this device. So correlation and censorship attacks tend to go hand-in-hand. 

Now, how can a transaction be de-anonymized? Right now, here's just a screenshot of [Wireshark](https://www.wireshark.org/), once again it's a free and open-source tool that is available for anybody to use. Users right now, you guys in the seats, me up here, you can use this, anybody can grab it. So, this screenshot shows exactly packets being captured and you can further click in and further get information on what these packets are doing and where they're going. So this is a perfect example of a tool that anybody can grab, use. And now, with an attacker, like a global passive adversary, obviously they are going to be much more well funded than a normal user or somebody in their basement hacking away. So just imagine if these tools are available for free what do you think a global passive adversary would use to further analyze traffic. 

So, where can we go, what can we do today? What can we do as of now, what can be done as users in your seats right now, users back home? What can they do? So, first I want to touch on VPN's. I'm sure most of us have heard this solution. VPN's are, high level, [virtual private networks](https://en.wikipedia.org/wiki/Virtual_private_network). They encrypt traffic from end to end, from your device to your destination. 

Hang on just a second. 

So, first of all, if we're looking for anonymity. VPN's with anonymity - we have to also understand what our threat model is. Once again, the threat model that we're looking at, or that I was looking at for this is the global passive adversary. So, you need to realize if you were trying to remain anonymous, how exactly are you going to obtain these VPNs subscriptions? VPN's work through specific subscriptions, you can pay for it. You can use free ones but I would advise you not to use that because once again if you are not-- they end up selling your data if you are getting it for free. So you need to obviously realize to go after trusted VPN providers. So if you're also looking for pure anonymity, you need to realize how you obtain the subscription, must also be done anonymously. So you can do, you can, certain VPN providers allow, accepting payment by cash, via the mail, so you can create the way it works is you create a profile through the site, they give you a subscription number, what you do is in an envelope, you put their address you send whatever your little numeric number that they give you is, nothing else is attached to you. Send it through the mail. That's how you can obtain your subscription. You can also buy it with Monero, or use gift cards. Gift cards, of course, if you're trying to do that anonymously obviously you would be paying cash, and you want to make sure that how-- if you're really worried about your level of anonymity you want to make sure that the facial recognition at the specific place that you're buying these gift cards, also is dissipated, so that's another level.

So really briefly I want to make a disclaimer, I'm not affiliated with "that one privacy site", or "that one privacy guy" but I think the tool that he has available, that he's made available online is an extremely good tool for anybody to use. I'm going to address that in the next slide.

So, a lot of times if you're looking for what is a good VPN provider you'll have these websites, if you go to search top 10 VPN's you'll have all these different sites say this is the best VPN, this is the best VPN, but a lot of times these websites, they are affiliates so they're paid to pump these different VPN's, so they're shilling these products. So what that one privacy guy aims to do is he is aiming to be as neutral as possible, and he makes a gigantic chart. With this chart he compares about a hundred different VPN's, and these hundred different VPN's he compares them in about thirty different categories, I've only got, I don't know, ten in this category. So, you need to realize if you're trying to become as anonymous as possible, jurisdiction, you gotta realize what jurisdiction it's located in what country it's located in, because of course, the legal issues come into play. Are they in a fourteen eyes country, are they in a country that's an enemy to the internet? Do they log IP's? Do they log DNS requests? How exactly do they accept payment? So there's many other tools that you can look into but this is just a little screenshot, like I said, of what exactly it looks like. 

So, the downside of using VPN's, of course, in the end, you're trusting a centralized system. We all know the issues with trusting a centralized system. Also, law enforcement agencies, like I mentioned before with jurisdiction, and subpoenas, if they're given a subpoena they have to, of course, observe whatever the law enforcement agency is saying in their country of origin. Of course with a large enough attacker, correlation attacks can also be carried out, and like I said we are imagining a global passive adversary so they are large enough, and with long enough time you can still de-anonymize this traffic.

Another tool that we can use today besides VPN's, [Tor](https://www.torproject.org/download/). So I'm sure most of us here understand, know what TOR is, but I'll just give a high-level rundown of what Tor aims to accomplish. Tor is The Onion Router, it uses onion routing to route your traffic. So, a good example is, or just an example of exactly how Tor works is, you're a user and you connect to three different nodes, and the way that these nodes, the node can only see one jump behind it and one jump in front of it, so it's a multi-hop system, and you go through three different nodes. So, your device connects to node one. Node one knows where the traffic originated from and knows that it's going to node two, but it doesn't know your destination. Now node two then gets that traffic. Node two knows that it came from node one, but it doesn't know where it originated from, and it knows that it's going to node three, but it doesn't know the destination. Now node three gets the traffic, node three only knows that it came from node two, and  the destination, but it doesn't know the origination at all. So, high level I hope that wasn't confusing, but high level that's what Tor aims to achieve. That's not including hidden services. 

So, I wanted to mention three operating systems that leverage Tor. First one is [Tails](https://tails.boum.org/). Tails is the amnesic operating system, it's a live bootable disc, so it's a USB that you can plug into your device, and all traffic is routed through Tor. And when you're done with it, it's non-persistent, so once you unplug tails the data's wiped, and when you go to use it again, you plug it back in, there's no information there, it's like a completely new session. Like I said, all data runs through Tor. 
	
[Whonix](https://www.whonix.org/) is another operating system that leverages Tor. Same exact thing, all traffic is routed through there. 
And then [Qubes](https://www.qubes-os.org/) is another operating system that virtualizes different cells for you to perform different operations in. You can then use a Whonix gateway to route all your traffic through Tor again. And you can also leverage AppVM if you're worried about VPN's you can also use VPN's, use it for VPN chaining. Putting a VPN around a VPN, nested VPN's really. 

Downsides of Tor, it's documentation says "Semi-trusted Directory Authorities" but they're trusted directory authorities. There's not many of them, and so once again we know the issues with trusted directory authorities with there being any kind of trust. Law enforcement agencies controlling exit nodes. We've seen the problems, we've seen academic papers coming out, and the amount of, we don't know the exact number of law enforcement agencies that control exit nodes but we know that it's being monitored.

Correlation attacks performed against nodes. We're assuming a global passive adversary, so we're expecting all nodes to be compromised. And of course [sybil attacks](https://en.wikipedia.org/wiki/Sybil_attack) can also be carried out as well.

Okay so I also wanted to talk about other crypto projects of importance. Of course, this is Monerokon of course. But, there are some very interesting projects that are trying to work on similar aspects.

Okay, first I wanted to touch on [Grin](https://grin-tech.org/). Grin implements [Dandelion](https://arxiv.org/pdf/1701.04439.pdf). So, high level, what dandelion aims to achieve is that during the stem phase it quietly propagates the network. It goes to a certain set of nodes, then once it reaches enough nodes, it reaches the fluff phase, where it then bursts out the transaction across the network. Now I just made sure I had clarification on this, with a global passive adversary this could still be de-anonymized because of course, the network is being completely surveilled. So Grin is also working in implementing I2P over transactions which, I will speak about I2P in a few minutes, just wanted to say that they're looking at that.

[Zcash](https://z.cash/) over Tor. Today you can use Zcash over Tor, you can also use Zcash over Tor. You can submit transactions to hidden services, using hidden services. So, that's something of note, as well as they're looking at mix networks, which I will also speak about in just a few moments.

I also want to talk about [Ethereum](https://www.ethereum.org/) private tokens. What [Enigma](https://enigma.co/) and [Aztec protocol](https://www.aztecprotocol.com/) are looking to use and leverage. So Enigma aims to leverage private smart contracts. So with these private smart contracts, the whole goal is to make sure anything inside the smart contracts, if you're not using Enigma right now you're using an openly available openly visible smart [contract](https://www.coindesk.com/information/ethereum-smart-contracts-work) that anybody can see that is viewing the network. With private smart contracts they aim to close that up. You can see though, this is the issue with Enigma, in the sense that you can still get network [metadata](https://techterms.com/definition/metadata), that this address is using a private smart contract. You can't tell what's going on inside it, but you can tell that you can glean from that information that they are using this private smart contract. 

Aztec protocol suffers from a similar fate. They are looking to do [confidential transactions](https://en.bitcoin.it/wiki/Confidential_transactions) over Ethereum. So once again it leverages that privacy on the network, but you can still tell that they're performing these transactions. You can't, at least from current analysis, you can't tell what they are exactly doing, but you can tell that they are sending private transactions on the chain.

What does the future hold? Where exactly are we going? What are possible, like I said in the near-term, and the long-term, solutions that could possibly be implemented? This isn't law, but these are just solutions that are out there. 

Our very own vtnerd will be speaking next, after me. He'll be speaking about broadcasting transactions over Tor, so I will let Lee touch on that, but I wanted to touch on [I2P-Zero](https://github.com/i2p-zero/i2p-zero) and [TinyI2P](https://gist.github.com/coneiric/a26ea711ed7abc7279416a7fb38a283e) as well as mixnets.

First with I2P-Zero and TinyI2P. [I2P](https://geti2p.net/en/) is the invisible internet project, and so they take the I2P takes what Tor does and takes it a little further. So TinyI2P and I2P-Zero, they're both I2P routers. TinyI2P is a lightweight C++ implementation of I2P while I2P-Zero is a Java implementation but you can use it cross-platform.

Now the difference between I2P and Tor is Tor only encrypts [TCP](https://en.wikipedia.org/wiki/Transmission_Control_Protocol) traffic while I2P encrypts both [UDP](https://en.wikipedia.org/wiki/User_Datagram_Protocol) and TCP traffic. Now in the upcoming Monero releases I believe Tor is already being pushed into it but I2P I think in upcoming releases we'll have I2P integration, so transmitting transactions over I2P.

[Mixnets](https://en.wikipedia.org/wiki/Mix_network) first came into, I guess the idea for mixnets first came into being, David Chaum's 1982 academic paper I believe, I believe it was 1982. So there's a few different systems for mixnets, I will be talking about the [loopix system](https://arxiv.org/pdf/1703.00536.pdf). So, mixnets then take what I2P does and what Tor aims to accomplish, and pushes it a little further. So, it offers protection against end-to-end correlation attacks. So, it aims to leverage this idea of sending random packets through nodes. Sometimes they are the real packets, sometimes they are, it's dummy data. So, by different nodes randomly sending out information, like I said, it could be the real data, it could be the false data or it could be false data, it could be just dummy data like I said. From all these different nodes, it creates that end-to-end correlation attack, it gives protection against those end-to-end correlation attacks. Because your node maybe, your device is also sending and receiving real and false data at the same time. So if somebody's watching, a global adversary is watching the network, they can still not, there's still plausible deniability. They can only tell that this person is using, or these individuals are using mixnets. This also allows for sender and receiver unobservability. Once again if your device is sending and receiving dummy data as well as real data, both Alice and Bob, if they are sending and receiving that information, you have that unobservability because once again there's that plausible deniability in the sense that you cannot tell if they are actually even submitting any transactions over the network or if it's just spam. So, also, I2P leverages, I did not say in the previous slide, the nodes are chosen randomly, as opposed to a centralized directory authority, each node chooses a random path. So once again those kinds of correlations are mitigated, those kinds of correlation attacks. Now, this is the one thing even I2P doesn't implement, are  timing held variations. So a timing attack can't really be performed at least for this level. So they hold these packets, let's say you're sending transactions, there are these different timing, they keep them in, let's say a certain escrow before they send it. But like I said that varies, the exact timing, it's not exactly, I don't have it defined here but that different timing scale can help mitigate let's say when your sending transactions. Though, I guess another question would sort of be if you're sending a transaction how does that timing delay, how can that affect block times, how can that affect actual transactions? But I didn't go into that, I just wanted to address packet delivery. 

So what exactly is the benefit of hiding your IP address and network metadata? Obviously, it offers censorship resistance. If no one can tell that you are actually using this network or you are going to be involved in using these types of networks, these types of obfuscation networks, they can't, let's say a global passive adversary can't go and decide that they want to go and censor your node, censor the nodes that are helping to process your transactions. Now does this give true anonymity? I think to say that it gives true anonymity, that's very naive, but how much does it really give us? Now before I finish this presentation I want to leave you with two questions.
 
First one, should these network layers solution be made mandatory? Similar to ring-signatures, how ring signatures we have an anonymity set of eleven, should your transaction always be put over the network over these kinds of other networks?

The other question is, when the IP network problem is solved, what is the next issue that the community will need to address to reach perfect anonymity? Let's say this solves the network issue, what are the other issues that we will face or the community will face to further anonymize transactions? 

In conclusion, network is one of the largest, last obstacles to address. It is very difficult to address anonymity systems. There's a reason Tor has been around for almost two decades, and even in their documentation, they do not address a global passive adversary. So anonymity systems are still very new, and they are on the forefront of trying to understand the issues. There are products that exist today that attempt to address this. Like I said the good and the bad, but there's also many projects to look towards and possibly implement. The goal for my talk was more or less to, besides just looking at Tor, besides just looking at I2P, besides just looking at mixnets, to realize that there are other solutions out there that can be leveraged. And from what I've seen the monero community is very very adaptive and they can look and sort of make the pieces fit, so I think that just even just getting the ball rolling and speaking from an educational standpoint of what other solutions are out there I think it's just a good conversation. So you can email me if there's any other question that you don't get here at josh@airfoilcapital.com and I will take other questions right now if you have any. Thank you. 

[applause]

How do you think we can communicate the subtleties between, say, Tor, I2P, mixnets, to someone who doesn't really understand what kind of IP addresses are, for example, in the GUI or a mobile wallet, how do we actually communicate that?

I think the easiest way is to, you know speak in their language. First to make it as simple as possible. First because if they don't understand the network level, even down to IP addresses, I feel like you have to give examples, like the talk before me, [the open money initiative](https://www.monerooutreach.org/monero-konferenco/jamaal-montasser.php). Those examples that you could see, the real-life examples that he had, from the people that were speaking how they had to do these transactions or how they could possibly do it and I think making it really apparent to them how exactly they could address this and then further extrapolating, maybe getting a little deeper and deeper and just explaining how this can affect you. I think just more or less starting out at a broad level and then bringing it down, I think that's, I mean if no one understands IP addresses then Tor, even explaining what Tor is, is going to be difficult, so I think just starting at a broad level here and just saying there's issues here, and give examples, I think that's super helpful.

There's a question out there.

Hi, I know there's been some workaround incentivized Tor-like nodes using cryptocurrencies. Do you have any thoughts on those and their application?

I haven't heard about incentivized nodes for Tor but I've heard about a decentralized VPN's that were also looking at leverage something similar to that. I think it's a smart way to get people involved. Now the only thing is, I think there's obviously game theory, game-theoretic issues that can come up that if you're incentivizing the right amount of people, or now if people say, listen I want to take this VPN offline, or this node offline so I can then obtain funds or I can get more of my traffic, then you have people that are attacking, there are people that are attacking these VPN nodes because they want to have their VPN node obtain the most throughput. I think that can be an issue there, or, obtain the most traffic, I think. So I don't really know, myself. I don't want to give a broad answer but I think putting that out there and saying, listen, let's see what happens, if it fails, I mean, well, you'll end up learning from it and you go, you know what, this didn't work but maybe something that uses some kind of consensus mechanism where people aren't incentivized to go destroy other nodes, I think that would be helpful as well. 


Thank you guys, thank you so much. 

